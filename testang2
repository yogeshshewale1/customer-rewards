import { Component } from '@angular/core';
import { CommonModule } from '@angular/common';
import { Router } from '@angular/router';
import { AdvertisementService } from '../../services/advertisement.service';
import { SearchPipe } from '../../pipes/search.pipe';
import { FormsModule } from '@angular/forms';

@Component({
  standalone: true,
  imports: [CommonModule, FormsModule, SearchPipe],
  template: `
    <input [(ngModel)]="searchText"
           placeholder="Search by title or name" />

    <table>
      <tr>
        <th>Title</th>
        <th>Name</th>
        <th>Category</th>
        <th>Actions</th>
      </tr>

      <tr *ngFor="let ad of service.getAll() | search:searchText">
        <td>{{ ad.title }}</td>
        <td>{{ ad.name }}</td>
        <td>{{ ad.category }}</td>
        <td>
          <a (click)="edit(ad.id)">EDIT</a> |
          <a (click)="remove(ad.id)">DELETE</a>
        </td>
      </tr>
    </table>
  `,
  styles: [`
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 6px;
    }
    a {
      cursor: pointer;
      color: blue;
    }
  `]
})
export class AdvertisementTableComponent {
  searchText = '';

  constructor(
    public service: AdvertisementService,
    private router: Router
  ) {}

  remove(id: number) {
    this.service.delete(id);
  }

  edit(id: number) {
    this.router.navigate(['/edit', id]);
  }
}
